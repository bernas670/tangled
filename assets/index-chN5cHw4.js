(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const x=document.getElementById("theme-toggle");if(!x)throw new Error("Theme toggle button not found");localStorage.getItem("theme")==="dark"&&document.body.classList.add("dark");function T(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}x.addEventListener("click",T);var m=(e=>(e.Empty="empty",e.Correct="correct",e.MisplacedBoth="misplaced-both",e.MisplacedRow="misplaced-row",e.MisplacedCol="misplaced-col",e.Absent="absent",e))(m||{}),a=(e=>(e.Row="row",e.Col="col",e))(a||{});const i=5,S="/tangled",y=()=>({misplaced:new Set,absent:new Set}),K=()=>({mode:a.Row,cursor:{row:0,col:0},grid:Array.from({length:i},()=>Array.from({length:i},()=>({letter:"",state:m.Empty}))),knowledge:{row:Array.from({length:i},y),col:Array.from({length:i},y)}}),C=K();let z=[],P=0;const Y=()=>fetch(`${S}/puzzles.txt`).then(e=>e.text()).then(e=>{z=e.split(`
`).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.split(/\s+/).map(n=>n.toUpperCase().split("")))}),B=()=>z[P]??[];let O=new Set;const X=()=>fetch(`${S}/guesses.txt`).then(e=>e.text()).then(e=>{O=new Set(e.split(`
`).map(o=>o.trim().toUpperCase()))}),U=e=>O.has(e),D=document.getElementById("board"),W=document.getElementById("keyboard"),$=()=>{const e=[];for(let o=0;o<i;o++){const n=[];for(let r=0;r<i;r++){const t=document.createElement("div");t.className="cell",t.style.gridRow=String(o+2),t.style.gridColumn=String(r+2),D.appendChild(t),n.push(t)}e.push(n)}return e},b=e=>Array.from({length:i},(o,n)=>{const r=document.createElement("div");return r.className=`knowledge ${e.className}`,r.style.gridRow=e.gridRow(n),r.style.gridColumn=e.gridColumn(n),D.appendChild(r),r}),w=$(),_=b({className:"row-misplaced",gridRow:e=>String(e+2),gridColumn:()=>"1"}),G=b({className:"row-absent",gridRow:e=>String(e+2),gridColumn:()=>"7"}),H=b({className:"col-misplaced",gridRow:()=>"1",gridColumn:e=>String(e+2)}),Z=b({className:"col-absent",gridRow:()=>"7",gridColumn:e=>String(e+2)}),F=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["MODE","Z","X","C","V","B","N","M","⌫"],["ENTER"]],V=()=>{const e=new Map;return F.forEach(o=>{const n=document.createElement("div");n.className="keyboard-row",o.forEach(r=>{const t=document.createElement("button");t.className="keyboard-key",t.dataset.key=r,r==="MODE"?t.classList.add("wide","mode-toggle","row-mode"):r==="⌫"?(t.textContent="⌫",t.classList.add("wide")):r==="ENTER"?(t.textContent="ENTER",t.style.maxWidth="100%",t.style.flex="1"):t.textContent=r,e.set(r,t),n.appendChild(t)}),W.appendChild(n)}),e},I=V(),f=(e,o,n,r)=>{e.forEach((t,s)=>{t.replaceChildren(),[...o[s][n]].sort().forEach(l=>{const d=document.createElement("div");d.className=`knowledge-cell ${r}`,d.textContent=l,t.appendChild(d)})})},j=e=>{for(let o=0;o<i;o++)for(let n=0;n<i;n++){const r=w[o][n],t=e.grid[o][n];r.className="cell",r.textContent=t.letter??"",r.classList.add(t.state)}},q=e=>{const{mode:o,cursor:n}=e;(o===a.Row?w[n.row]:w.map(t=>t[n.col])).forEach(t=>t.classList.add("highlight")),w[n.row][n.col].classList.add("cursor")},p=e=>{j(e),q(e),f(_,e.knowledge.row,"misplaced","misplaced-row"),f(G,e.knowledge.row,"absent","absent"),f(H,e.knowledge.col,"misplaced","misplaced-col"),f(Z,e.knowledge.col,"absent","absent")},R=(e,o,n,r)=>({row:e===a.Row?o:r,col:e===a.Row?r:n}),J=(e,o,n,r)=>{e.knowledge.row[o].misplaced.delete(r),e.knowledge.row[o].absent.delete(r),e.knowledge.col[n].misplaced.delete(r),e.knowledge.col[n].absent.delete(r)},Q=(e,o,n,r)=>{const t=B(),s=t[n].some((l,d)=>l===o.letter&&e.grid[n][d].state!==m.Correct),c=t.some((l,d)=>l[r]===o.letter&&e.grid[d][r].state!==m.Correct);s&&c?(o.state=m.MisplacedBoth,e.knowledge.row[n].misplaced.add(o.letter),e.knowledge.col[r].misplaced.add(o.letter)):s?(o.state=m.MisplacedRow,e.knowledge.row[n].misplaced.add(o.letter),e.knowledge.col[r].absent.add(o.letter)):c?(o.state=m.MisplacedCol,e.knowledge.col[r].misplaced.add(o.letter),e.knowledge.row[n].absent.add(o.letter)):(o.state=m.Absent,e.knowledge.row[n].absent.add(o.letter),e.knowledge.col[r].absent.add(o.letter))},L=e=>{const{mode:o,grid:n,cursor:r}=e,t=o===a.Row?n[r.row]:n.map(l=>l[r.col]),s=t.map(l=>l.letter).join("");if(s.length<i)return{success:!1,error:"incomplete"};if(!U(s))return{success:!1,error:"invalid"};const c=B();return t.forEach((l,d)=>{const{row:g,col:u}=R(o,r.row,r.col,d),k=o===a.Row?c[r.row][d]:c[d][r.col];l.letter===k&&(l.state=m.Correct),e.knowledge.col[u].misplaced.delete(l.letter),e.knowledge.row[g].misplaced.delete(l.letter)}),t.forEach((l,d)=>{if(l.state===m.Correct)return;const{row:g,col:u}=R(o,r.row,r.col,d);J(e,g,u,l.letter),Q(e,l,g,u)}),{success:!0}},ee=e=>e.mode===a.Row?w[e.cursor.row]:w.map(o=>o[e.cursor.col]),A=e=>{const o=ee(e),r=e.mode===a.Row?[{transform:"translateX(0)"},{transform:"translateX(-6px)"},{transform:"translateX(6px)"},{transform:"translateX(-4px)"},{transform:"translateX(4px)"},{transform:"translateX(0)"}]:[{transform:"translateY(0)"},{transform:"translateY(-6px)"},{transform:"translateY(6px)"},{transform:"translateY(-4px)"},{transform:"translateY(4px)"},{transform:"translateY(0)"}];o.forEach(t=>{t.animate(r,{duration:400,easing:"ease-in-out"})})},h=e=>{e.mode=e.mode===a.Row?a.Col:a.Row,oe(e)},oe=e=>{const o=I.get("MODE");o&&(o.classList.toggle("row-mode",e.mode===a.Row),o.classList.toggle("col-mode",e.mode===a.Col))},E=(e,o)=>{const n=o==="down"||o==="right"?1:i-1;o==="up"||o==="down"?e.cursor.row=(e.cursor.row+n)%i:e.cursor.col=(e.cursor.col+n)%i},M=e=>{const{row:o,col:n}=e.cursor;e.grid[o][n].state!==m.Correct&&(e.grid[o][n]={letter:"",state:m.Empty}),e.mode===a.Row?e.cursor.col=Math.max(e.cursor.col-1,0):e.cursor.row=Math.max(e.cursor.row-1,0)},v=(e,o)=>{const{row:n,col:r}=e.cursor,t=e.grid[n][r];t.state!==m.Correct&&(t.letter=o.toUpperCase(),e.mode===a.Row?e.cursor.col=Math.min(i-1,e.cursor.col+1):e.cursor.row=Math.min(i-1,e.cursor.row+1))},N=(e,o,n)=>{e.cursor.row=o,e.cursor.col=n},re=e=>{window.addEventListener("keydown",s=>{switch(s.key){case" ":s.preventDefault(),h(e);break;case"ArrowUp":E(e,"up");break;case"ArrowDown":E(e,"down");break;case"ArrowLeft":E(e,"left");break;case"ArrowRight":E(e,"right");break;case"Backspace":M(e);break;case"Enter":{const c=L(e);!c.success&&c.error==="invalid"&&A(e);break}default:/^[a-zA-Z]$/.test(s.key)&&v(e,s.key)}p(e)});let o=0,n=null;const r=300;w.forEach((s,c)=>{s.forEach((l,d)=>{l.addEventListener("click",()=>{N(e,c,d),p(e)}),l.addEventListener("dblclick",()=>{N(e,c,d),h(e),p(e)}),l.addEventListener("touchend",g=>{const u=Date.now();n?.row===c&&n?.col===d&&u-o<r?(g.preventDefault(),h(e),p(e),o=0,n=null):(o=u,n={row:c,col:d})})})});const t=s=>{switch(s){case"MODE":h(e);break;case"⌫":M(e);break;case"ENTER":{const c=L(e);!c.success&&c.error==="invalid"&&A(e);break}default:/^[A-Z]$/.test(s)&&v(e,s)}p(e)};I.forEach((s,c)=>{s.addEventListener("click",l=>{l.preventDefault(),t(c)})})};Promise.all([X(),Y()]).then(()=>{console.log("Game data loaded"),re(C),p(C)});
