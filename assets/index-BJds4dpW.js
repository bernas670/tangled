(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&t(d)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const I=document.getElementById("theme-toggle");if(!I)throw new Error("Theme toggle button not found");localStorage.getItem("theme")==="dark"&&document.body.classList.add("dark");function D(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}I.addEventListener("click",D);var m=(e=>(e.Empty="empty",e.Correct="correct",e.MisplacedBoth="misplaced-both",e.MisplacedRow="misplaced-row",e.MisplacedCol="misplaced-col",e.Absent="absent",e))(m||{}),a=(e=>(e.Row="row",e.Col="col",e))(a||{});const i=5,T="/tangled",L=()=>({misplaced:new Set,absent:new Set}),M=()=>({mode:a.Row,cursor:{row:0,col:0},grid:Array.from({length:i},()=>Array.from({length:i},()=>({letter:"",state:m.Empty}))),knowledge:{row:Array.from({length:i},L),col:Array.from({length:i},L)},tries:{row:Array.from({length:i},()=>0),col:Array.from({length:i},()=>0)}}),b=M(),Y=e=>{const o=M();e.mode=o.mode,e.cursor=o.cursor,e.grid=o.grid,e.knowledge=o.knowledge,e.tries=o.tries};let k=[],P=1;const U=()=>fetch(`${T}/puzzles.txt`).then(e=>e.text()).then(e=>{k=e.split(`
`).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.split(/\s+/).map(r=>r.toUpperCase().split("")))}),K=()=>k[P]??[],$=e=>{e>=0&&e<k.length&&(P=e)};let B=new Set;const X=()=>fetch(`${T}/guesses.txt`).then(e=>e.text()).then(e=>{B=new Set(e.split(`
`).map(o=>o.trim().toUpperCase()))}),_=e=>B.has(e),R=document.getElementById("board"),W=document.getElementById("keyboard"),Z=()=>{const e=document.createElement("div");e.className="tries-container",e.style.gridRow="1",e.style.gridColumn="1";const o=document.createElement("div");o.className="tries-label",o.textContent="TRIES";const r=document.createElement("div");return r.className="tries-count",r.textContent="0",e.appendChild(o),e.appendChild(r),R.appendChild(e),r},G=Z(),H=()=>{const e=[];for(let o=0;o<i;o++){const r=[];for(let t=0;t<i;t++){const n=document.createElement("div");n.className="cell",n.style.gridRow=String(o+2),n.style.gridColumn=String(t+2),R.appendChild(n),r.push(n)}e.push(r)}return e},E=e=>Array.from({length:i},(o,r)=>{const t=document.createElement("div");return t.className=`knowledge ${e.className}`,t.style.gridRow=e.gridRow(r),t.style.gridColumn=e.gridColumn(r),R.appendChild(t),t}),p=H(),F=E({className:"row-misplaced",gridRow:e=>String(e+2),gridColumn:()=>"1"}),V=E({className:"row-absent",gridRow:e=>String(e+2),gridColumn:()=>"7"}),j=E({className:"col-misplaced",gridRow:()=>"1",gridColumn:e=>String(e+2)}),q=E({className:"col-absent",gridRow:()=>"7",gridColumn:e=>String(e+2)}),J=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["ENTER","Z","X","C","V","B","N","M","⌫"]],Q=()=>{const e=new Map;return J.forEach(o=>{const r=document.createElement("div");r.className="keyboard-row",o.forEach(t=>{const n=document.createElement("button");n.className="keyboard-key",n.dataset.key=t,t==="ENTER"?(n.textContent="ENTER",n.classList.add("wide")):t==="⌫"?(n.textContent="⌫",n.classList.add("wide")):n.textContent=t,e.set(t,n),r.appendChild(n)}),W.appendChild(r)}),e},O=Q(),f=(e,o,r,t)=>{e.forEach((n,s)=>{n.replaceChildren(),[...o[s][r]].sort().forEach(c=>{const l=document.createElement("div");l.className=`knowledge-cell ${t}`,l.textContent=c,n.appendChild(l)})})},ee=e=>{for(let o=0;o<i;o++)for(let r=0;r<i;r++){const t=p[o][r],n=e.grid[o][r];t.className="cell",t.textContent=n.letter??"",t.classList.add(n.state)}},oe=e=>{const{mode:o,cursor:r}=e;(o===a.Row?p[r.row]:p.map(n=>n[r.col])).forEach(n=>n.classList.add("highlight")),p[r.row][r.col].classList.add("cursor")},re=["correct","misplaced-row","misplaced-col","absent"],te=e=>{const o=e.tries.row.reduce((r,t)=>r+t,0)+e.tries.col.reduce((r,t)=>r+t,0);G.textContent=String(o)},ne=e=>{const{mode:o,cursor:r}=e,t=o===a.Row?r.row:r.col,n=o===a.Row?e.knowledge.row[t]:e.knowledge.col[t],s=o===a.Row?"misplaced-row":"misplaced-col",c=(o===a.Row?e.grid[r.row]:e.grid.map(l=>l[r.col])).filter(l=>l.state===m.Correct).map(l=>l.letter);O.forEach((l,u)=>{/^[A-Z]$/.test(u)&&(l.classList.remove(...re),c.includes(u)&&l.classList.add("correct"),n.misplaced.has(u)?l.classList.add(s):n.absent.has(u)&&l.classList.add("absent"))})},g=e=>{ee(e),oe(e),f(F,e.knowledge.row,"misplaced","misplaced-row"),f(V,e.knowledge.row,"absent","absent"),f(j,e.knowledge.col,"misplaced","misplaced-col"),f(q,e.knowledge.col,"absent","absent"),te(e),ne(e)},A=(e,o,r,t)=>({row:e===a.Row?o:t,col:e===a.Row?t:r}),se=(e,o,r,t)=>{e.knowledge.row[o].misplaced.delete(t),e.knowledge.row[o].absent.delete(t),e.knowledge.col[r].misplaced.delete(t),e.knowledge.col[r].absent.delete(t)},le=(e,o,r,t)=>{const n=K(),s=n[r].some((c,l)=>c===o.letter&&e.grid[r][l].state!==m.Correct),d=n.some((c,l)=>c[t]===o.letter&&e.grid[l][t].state!==m.Correct);s&&d?(o.state=m.MisplacedBoth,e.knowledge.row[r].misplaced.add(o.letter),e.knowledge.col[t].misplaced.add(o.letter)):s?(o.state=m.MisplacedRow,e.knowledge.row[r].misplaced.add(o.letter),e.knowledge.col[t].absent.add(o.letter)):d?(o.state=m.MisplacedCol,e.knowledge.col[t].misplaced.add(o.letter),e.knowledge.row[r].absent.add(o.letter)):(o.state=m.Absent,e.knowledge.row[r].absent.add(o.letter),e.knowledge.col[t].absent.add(o.letter))},z=e=>{const{mode:o,grid:r,cursor:t}=e,n=o===a.Row?r[t.row]:r.map(c=>c[t.col]),s=n.map(c=>c.letter).join("");if(s.length<i)return{success:!1,error:"incomplete"};if(!_(s))return{success:!1,error:"invalid"};const d=K();return n.forEach((c,l)=>{const{row:u,col:w}=A(o,t.row,t.col,l),y=o===a.Row?d[t.row][l]:d[l][t.col];c.letter===y&&(c.state=m.Correct),e.knowledge.col[w].misplaced.delete(c.letter),e.knowledge.row[u].misplaced.delete(c.letter)}),n.forEach((c,l)=>{if(c.state===m.Correct)return;const{row:u,col:w}=A(o,t.row,t.col,l);se(e,u,w,c.letter),le(e,c,u,w)}),o===a.Row?e.tries.row[t.row]++:e.tries.col[t.col]++,{success:!0}},ce=e=>e.mode===a.Row?p[e.cursor.row]:p.map(o=>o[e.cursor.col]),S=e=>{const o=ce(e),t=e.mode===a.Row?[{transform:"translateX(0)"},{transform:"translateX(-6px)"},{transform:"translateX(6px)"},{transform:"translateX(-4px)"},{transform:"translateX(4px)"},{transform:"translateX(0)"}]:[{transform:"translateY(0)"},{transform:"translateY(-6px)"},{transform:"translateY(6px)"},{transform:"translateY(-4px)"},{transform:"translateY(4px)"},{transform:"translateY(0)"}];o.forEach(n=>{n.animate(t,{duration:400,easing:"ease-in-out"})})},C=e=>{e.mode=e.mode===a.Row?a.Col:a.Row},h=(e,o)=>{const r=o==="down"||o==="right"?1:i-1;o==="up"||o==="down"?e.cursor.row=(e.cursor.row+r)%i:e.cursor.col=(e.cursor.col+r)%i},N=e=>{const{row:o,col:r}=e.cursor;e.grid[o][r].state!==m.Correct&&(e.grid[o][r]={letter:"",state:m.Empty}),e.mode===a.Row?e.cursor.col=Math.max(e.cursor.col-1,0):e.cursor.row=Math.max(e.cursor.row-1,0)},v=(e,o)=>{const{row:r,col:t}=e.cursor,n=e.grid[r][t];n.state!==m.Correct&&(n.letter=o.toUpperCase(),e.mode===a.Row?e.cursor.col=Math.min(i-1,e.cursor.col+1):e.cursor.row=Math.min(i-1,e.cursor.row+1))},x=(e,o,r)=>{e.cursor.row=o,e.cursor.col=r},de=e=>{window.addEventListener("keydown",s=>{switch(s.key){case" ":s.preventDefault(),C(e);break;case"ArrowUp":h(e,"up");break;case"ArrowDown":h(e,"down");break;case"ArrowLeft":h(e,"left");break;case"ArrowRight":h(e,"right");break;case"Backspace":N(e);break;case"Enter":{z(e).success||S(e);break}default:/^[a-zA-Z]$/.test(s.key)&&v(e,s.key)}g(e)});let o=0,r=null;const t=300;p.forEach((s,d)=>{s.forEach((c,l)=>{c.addEventListener("click",()=>{x(e,d,l),g(e)}),c.addEventListener("dblclick",()=>{x(e,d,l),C(e),g(e)}),c.addEventListener("touchend",u=>{const w=Date.now();r?.row===d&&r?.col===l&&w-o<t?(u.preventDefault(),C(e),g(e),o=0,r=null):(o=w,r={row:d,col:l})})})});const n=s=>{switch(s){case"⌫":N(e);break;case"ENTER":{z(e).success||S(e);break}default:/^[A-Z]$/.test(s)&&v(e,s)}g(e)};O.forEach((s,d)=>{s.addEventListener("click",c=>{c.preventDefault(),n(d)})})},ae=()=>{const o=new URLSearchParams(window.location.search).get("puzzle");return o&&/^\d+$/.test(o)?parseInt(o,10):null};Promise.all([X(),U()]).then(()=>{console.log("Game data loaded");const e=ae();e!==null&&($(e),Y(b)),de(b),g(b)});
